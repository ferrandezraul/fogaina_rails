<section id="body">
  <h1><%= @page.title %></h1>
  <ul id="breads">

    <% @breads.each_slice(3).with_index do |slice, slice_index| %>
      <div class="row">
        <% slice.each_with_index do |bread, b_index| %>
        
          <div class="large-4 columns">
            <%-# foundation_styles defined in helper -%>
            <div class="bread-image-wrapper overlay-<%=foundation_styles[b_index % foundation_styles.size] %>">
              <% if bread.photo %>
                <%= image_tag bread.photo.url %>
              <% else %>
                <%= image_tag "logo_negro.svg" %>
              <% end %>
              
              <div class="image-overlay-content">
                <h2><%= bread.name %></h2>
                <p><%= raw bread.description[0..40] + " ..." if bread.description %></p>

                <% if bread.price %>
                  <p class="price"><%= raw sprintf("%.2f", bread.price ) + " â‚¬" %></p>
                <% end %>

                <%= link_to I18n.t('read_more'), refinery.breads_bread_path(bread), class: "button" if bread.description %>
              </div>
            
            </div>    
          </div>
        
        <% end %>

        <%-# At the last slice, add empty columns if needed -%>
        <% rows_empty = extra_empty_rows(@breads) %>
        <% last_index = last_index_slice_of_three(@breads) %>
        <% if ( slice_index == last_index ) && rows_empty > 0 %>
          <% rows_empty.times do %>
            <div class="large-4 columns">
            </div>
          <% end %>
        <% end %>

      </div>
      
    <% end %>
  </ul>
</section>
